#ifndef _LIBENCLOUD_HTTP_SERVER_H_
#define _LIBENCLOUD_HTTP_SERVER_H_

#include <QObject>
#include <encloud/Common>
#include <encloud/HttpAbstractHandler>

// default port in case nothing is written to registry
#define LIBENCLOUD_SRV_PORT_DFT 4804

namespace libencloud {

class Config;
class HttpServerPriv;

class LIBENCLOUD_DLLSPEC HttpServer : public QObject
{
    Q_OBJECT;

    friend class Core;
    friend class HttpServerPriv;

public:
    HttpServer ();
    ~HttpServer ();

    HttpAbstractHandler *getHandler ();
    int setHandler (HttpAbstractHandler *handler);

    int start ();
    int stop ();
    bool isListening ();

public slots:
    void vpnIpAssigned (const QString &ip);

private:
    Config *_cfg;
    HttpServerPriv *_localServer;
    HttpServerPriv *_cloudServer;
    HttpAbstractHandler *_handler;
};

}  // namespace libencloud

#endif  // _LIBENCLOUD_HTTP_SERVER_H_
