#ifndef _LIBENCLOUD_API_SETUP_H_
#define _LIBENCLOUD_API_SETUP_H_

#include <QObject>
#include <QUuid>
#include <encloud/Common>
#include <encloud/Api/CommonApi>

/**
 * Qt helper to interact with Encloud's HTTP Setup API.
 * 
 * Please refer to doc/APIv* for details.
 */

namespace libencloud {

class LIBENCLOUD_DLLSPEC SetupApi : public Api
{
    Q_OBJECT

public:

    SetupApi ();
    ~SetupApi ();


public slots:

    //
    // ALL
    //
    void verifyCASupply (bool b);

    //
    // ECE-only
    //
    void poiRetrieve ();

    //
    // SECE-only
    //
    void licenseSupply (const QUuid &uuid);

    //
    // QIC-only
    //
    void portSupply (int port);
    void configRetrieve ();

signals:

    //
    // ALL
    // 

    void verifyCASent (libencloud::Api::ResultCode rc);

    //
    // ECE-only
    //
    void poiReceived (libencloud::Api::ResultCode rc,
            QUuid poi = QUuid());

    //
    // SECE-only
    //

    // Note: success only indicates correct message delivery
    // Status API must be checked for further license "needs"
    void licenseSent (libencloud::Api::ResultCode rc);

    //
    // QIC-only
    //
    void portSent (libencloud::Api::ResultCode rc);
    void configReceived (libencloud::Api::ResultCode rc,
            const QVariant &config);

protected slots:

    void _error (const libencloud::Error &err);
    void _clientComplete (const QString &response);

protected:

    typedef enum 
    {
        NoneType,
        VerifyCASupplyType,
        PoiRetrieveType,
        LicenseSupplyType,
        PortSupplyType,
        ConfigRetrieveType
    }
    MsgType; 

    MsgType _msgType;
};

}  // namespace libencloud

#endif  // _LIBENCLOUD_API_SETUP_H_
